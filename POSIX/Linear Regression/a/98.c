#include <stdio.h>
#include <math.h>

/******************************************************************************
 * This program takes an initial estimate of m and c and finds the associated 
 * rms error. It is then as a base to generate and evaluate 8 new estimates, 
 * which are steps in different directions in m-c space. The best estimate is 
 * then used as the base for another iteration of "generate and evaluate". This 
 * continues until none of the new estimates are better than the base. This is
 * a gradient search for a minimum in mc-space.
 * 
 * To compile:
 *   cc -o 98 98.c -lm
 * 
 * To run:
 *   ./98 > results.csv
 * 
 * Dr Kevan Buckley, University of Wolverhampton, 2018
 *****************************************************************************/

typedef struct point_t {
  double x;
  double y;
} point_t;

int n_data = 1000;
point_t data[];

void print_data(){
  int i;
  for(i=0;i<n_data;i++){
    printf("%0.2lf,%0.2lf\n", data[i].x, data[i].y);
  }
}

int main() {
  print_data();
  return 0;
}

point_t data[] = {
  {82.47,152.95},{89.45,152.92},{65.58,130.69},{78.80,133.20},
  {83.52,144.08},{73.07,147.48},{78.17,131.14},{71.16,138.07},
  {72.79,137.28},{64.84,135.43},{59.22,107.15},{ 9.26,38.28},
  {95.51,152.40},{64.28,120.57},{14.24,57.30},{35.40,75.19},
  { 2.56,34.33},{50.83,89.77},{63.47,128.12},{60.91,106.34},
  {39.82,96.65},{43.97,81.21},{12.97,40.34},{62.20,102.52},
  {29.14,75.08},{12.23,40.93},{57.23,128.40},{52.94,116.35},
  {58.74,110.58},{25.17,67.27},{74.77,126.53},{92.51,144.15},
  {74.68,136.30},{36.32,91.52},{65.54,132.20},{70.22,133.88},
  {77.67,123.01},{48.90,108.24},{90.46,156.40},{63.05,113.11},
  {14.11,53.59},{42.37,94.62},{33.56,89.74},{99.34,171.87},
  {43.19,100.56},{21.81,64.83},{21.17,58.30},{ 3.24,40.97},
  {48.96,122.21},{ 1.96,30.95},{60.99,125.39},{30.20,77.10},
  {95.19,163.70},{87.37,159.95},{75.90,149.40},{65.72,134.95},
  {67.15,124.60},{76.45,147.90},{39.72,85.51},{89.18,166.31},
  {80.18,134.31},{99.36,170.28},{53.53,98.48},{17.17,60.70},
  {80.76,136.75},{33.58,63.69},{85.39,153.33},{13.04,60.39},
  {49.76,107.92},{46.27,96.46},{71.15,143.07},{75.72,135.13},
  {74.74,135.22},{16.04,40.10},{ 9.85,31.19},{50.69,96.95},
  { 8.69,25.10},{77.43,133.95},{ 3.23,43.89},{98.62,175.21},
  {27.59,75.27},{44.40,113.94},{ 4.67,50.70},{39.36,82.75},
  {33.09,85.33},{53.28,103.63},{39.69,114.73},{72.91,146.85},
  {67.62,117.79},{14.82,54.28},{93.78,176.22},{18.19,46.69},
  {53.45,94.46},{60.42,121.24},{95.51,164.32},{19.48,77.06},
  {53.77,92.03},{28.68,74.30},{76.18,153.48},{21.58,72.15},
  {39.76,82.84},{54.80,115.23},{36.30,74.91},{99.64,172.90},
  {46.25,94.50},{20.00,76.46},{70.86,142.27},{67.32,146.10},
  {89.31,154.63},{93.22,176.20},{10.97,36.78},{13.34,58.41},
  {38.07,92.72},{ 7.36,56.44},{ 1.64,37.85},{81.45,139.07},
  {94.93,174.63},{69.23,139.19},{43.18,83.85},{20.46,83.05},
  { 9.28,49.27},{16.50,60.37},{62.25,126.38},{38.61,88.22},
  {65.82,131.58},{ 8.32,33.88},{76.91,141.87},{81.07,146.08},
  {52.06,83.97},{46.27,94.79},{23.62,83.92},{54.64,119.15},
  {16.55,61.08},{86.44,140.28},{25.06,81.81},{24.86,78.20},
  {13.27,39.31},{10.95,43.13},{42.99,92.72},{77.87,136.77},
  {44.12,84.17},{53.65,114.95},{59.66,108.78},{77.20,132.32},
  {23.06,69.13},{59.26,104.91},{85.16,154.66},{92.98,159.90},
  {88.96,148.28},{ 0.93,44.04},{88.24,160.29},{94.61,168.73},
  {73.57,139.51},{39.68,72.61},{20.25,53.31},{78.66,145.69},
  {86.70,180.78},{75.45,149.01},{59.69,127.78},{52.43,103.62},
  {85.04,154.74},{60.28,124.83},{41.80,77.52},{73.97,143.68},
  { 5.49,46.83},{92.55,139.59},{89.43,155.86},{ 5.82,36.29},
  {93.87,175.27},{ 8.13,57.60},{23.70,61.86},{21.66,61.17},
  {83.85,164.64},{ 5.34,46.79},{81.22,147.71},{59.07,90.24},
  {41.46,82.19},{53.02,100.49},{57.88,127.45},{61.33,108.51},
  { 3.64,46.49},{96.75,179.96},{19.37,60.39},{97.65,178.74},
  {76.50,154.83},{51.17,84.41},{13.54,30.25},{91.86,158.56},
  {30.10,67.45},{26.48,46.30},{71.92,133.47},{18.75,63.52},
  {39.22,82.42},{53.15,110.51},{85.38,160.22},{17.71,56.86},
  {38.31,86.34},{22.89,62.05},{28.46,84.14},{59.58,109.60},
  {23.73,61.64},{92.49,165.81},{29.78,68.32},{ 8.47,60.45},
  {44.74,106.42},{26.42,68.58},{77.98,140.27},{32.82,68.26},
  {87.95,172.06},{92.50,154.98},{92.75,154.84},{69.32,128.65},
  { 1.55,30.79},{83.36,150.38},{77.74,159.00},{54.13,107.09},
  {43.48,99.27},{91.53,155.39},{91.28,154.74},{67.58,123.59},
  {73.18,122.72},{95.94,182.55},{67.23,124.50},{85.98,161.38},
  {42.83,86.94},{27.72,103.65},{35.75,85.95},{ 7.31,43.44},
  {93.94,163.35},{37.34,75.54},{ 4.49,28.42},{82.74,154.50},
  {35.63,90.26},{ 4.88,39.82},{37.38,78.96},{ 1.22,29.49},
  {12.80,63.38},{ 7.82,51.41},{75.27,141.78},{49.98,94.40},
  {11.97,43.17},{63.41,128.74},{26.22,65.95},{57.70,118.49},
  {17.89,86.04},{72.74,139.59},{49.45,87.60},{ 2.28,40.11},
  {17.29,60.57},{83.12,157.39},{ 6.26,29.75},{84.55,155.35},
  {51.28,100.86},{89.41,153.07},{67.11,145.72},{71.14,122.61},
  {83.49,146.49},{16.04,57.66},{79.56,144.04},{55.08,99.95},
  {88.01,152.61},{71.70,133.64},{62.19,103.73},{86.30,168.23},
  {21.92,55.01},{ 9.54,36.02},{39.49,81.11},{66.99,131.47},
  { 4.34,52.72},{79.97,141.27},{53.34,114.42},{88.64,153.69},
  {99.85,175.00},{ 8.28,58.89},{16.18,52.70},{76.38,135.28},
  {64.56,128.60},{13.02,41.80},{38.78,93.33},{51.72,103.70},
  {14.07,55.05},{64.32,138.45},{ 3.32,22.96},{18.39,64.84},
  {38.55,86.91},{72.53,113.94},{24.07,75.61},{68.39,133.47},
  {75.44,136.27},{26.52,76.28},{ 0.29,25.34},{28.47,67.62},
  {20.91,65.62},{65.55,125.35},{56.73,113.93},{94.04,173.68},
  {45.65,100.25},{15.86,41.27},{ 2.43,47.02},{ 1.36,35.24},
  {11.26,60.33},{33.06,81.11},{95.84,166.53},{87.34,150.73},
  {15.28,49.88},{79.59,119.74},{34.27,77.07},{77.48,136.07},
  {33.74,76.79},{52.90,105.16},{40.09,90.19},{22.94,65.86},
  {97.96,165.45},{11.15,48.29},{66.63,137.85},{40.74,75.56},
  {15.75,45.99},{95.84,165.80},{12.26,40.18},{31.60,72.20},
  {47.68,100.04},{15.62,56.60},{23.30,54.81},{ 5.25,57.60},
  { 1.75,32.25},{ 0.58,33.24},{ 9.09,43.20},{80.00,148.23},
  {93.63,169.43},{78.17,136.95},{65.03,135.50},{96.68,162.33},
  {87.13,156.60},{48.16,78.57},{92.72,150.93},{76.17,143.40},
  {18.24,55.83},{ 5.73,36.42},{14.43,45.13},{84.92,161.94},
  {73.18,140.43},{12.72,55.75},{79.61,145.13},{ 5.73,33.47},
  {57.95,117.32},{ 2.81,37.84},{12.23,61.48},{80.56,142.06},
  {45.29,90.26},{ 9.71,50.20},{18.10,66.94},{49.45,100.22},
  {25.77,66.81},{47.30,89.18},{81.58,159.81},{45.67,90.76},
  {87.31,141.82},{41.71,99.72},{53.95,102.53},{95.40,182.16},
  {78.80,143.21},{59.41,112.85},{43.75,101.90},{87.31,144.32},
  {65.40,130.32},{26.83,65.86},{79.12,141.12},{59.77,123.72},
  {19.80,81.54},{ 0.02,33.65},{37.39,85.93},{69.96,150.24},
  {38.87,90.59},{26.81,62.35},{ 3.33,39.23},{95.66,164.07},
  {94.67,161.55},{10.68,34.87},{31.28,72.89},{20.80,57.01},
  {77.28,143.81},{12.75,42.01},{61.36,119.56},{90.89,163.36},
  {84.04,118.32},{53.37,103.31},{21.78,79.21},{38.13,101.39},
  {42.23,78.54},{40.53,92.92},{88.08,125.82},{55.93,110.75},
  { 8.06,52.16},{12.87,46.30},{94.08,155.98},{16.39,53.22},
  {83.12,154.13},{14.20,56.53},{10.71,36.69},{86.08,154.74},
  {43.53,91.22},{57.98,105.40},{40.17,99.98},{82.56,142.71},
  {65.32,131.48},{10.42,68.36},{19.42,71.07},{59.05,110.30},
  {77.32,127.27},{64.44,120.13},{15.84,65.86},{79.94,163.95},
  {85.25,152.44},{91.76,160.23},{39.21,85.18},{14.63,48.61},
  {13.83,52.72},{ 7.54,34.96},{43.09,92.06},{93.45,174.39},
  {27.60,67.64},{46.15,107.16},{26.08,61.62},{61.42,103.39},
  {72.40,143.71},{36.68,99.54},{94.05,167.27},{ 7.58,35.83},
  {11.39,50.43},{38.64,69.18},{84.90,162.96},{27.20,51.23},
  {53.20,98.67},{ 9.42,37.79},{16.30,61.20},{59.60,114.31},
  { 5.20,33.32},{ 2.95,53.72},{52.76,119.86},{85.80,142.58},
  { 0.21,49.13},{93.15,148.71},{48.76,101.32},{79.76,138.77},
  {92.86,160.85},{23.87,69.21},{95.63,143.28},{23.19,79.10},
  {83.89,156.41},{23.17,51.15},{85.45,170.09},{71.31,154.02},
  {60.67,128.91},{40.93,96.50},{31.79,80.63},{80.88,145.22},
  {70.80,109.57},{ 4.70,48.41},{49.98,105.63},{63.80,142.92},
  {14.32,59.88},{71.28,136.60},{ 6.61,48.66},{55.36,118.69},
  {41.93,88.84},{ 0.17,52.71},{58.79,119.44},{78.38,133.20},
  {38.97,100.37},{44.96,99.51},{37.36,96.67},{94.86,174.86},
  {26.18,76.99},{14.66,38.70},{89.60,165.95},{19.38,50.53},
  {96.44,166.37},{36.24,97.79},{14.47,58.57},{18.22,74.34},
  {13.16,47.28},{85.76,147.76},{ 2.76,20.41},{48.28,92.09},
  {18.04,56.86},{41.34,95.12},{40.30,89.44},{44.97,106.55},
  {93.58,167.84},{75.28,140.13},{61.88,131.19},{ 0.02,24.89},
  {92.91,144.66},{23.02,63.37},{37.94,80.00},{76.77,139.30},
  {57.79,94.77},{ 2.48,51.24},{71.44,139.20},{42.54,89.20},
  {95.27,176.64},{51.16,98.09},{ 4.75,56.59},{60.50,120.21},
  {18.54,72.35},{72.70,137.27},{97.20,170.32},{14.23,45.31},
  {89.00,164.98},{99.04,154.33},{50.72,107.98},{25.61,68.40},
  {42.95,78.91},{82.03,148.13},{97.15,193.31},{29.93,85.49},
  {94.79,168.13},{68.14,133.58},{ 5.54,26.81},{37.62,93.36},
  {30.12,84.68},{45.76,84.60},{75.74,137.77},{52.82,100.94},
  {24.66,61.37},{73.15,131.61},{ 8.61,44.52},{89.95,156.95},
  {29.65,87.96},{ 8.36,41.39},{40.54,97.39},{63.09,125.22},
  {17.03,67.49},{24.09,58.92},{48.94,101.95},{38.03,73.78},
  {17.38,53.92},{33.11,68.97},{14.87,45.80},{59.88,124.98},
  {85.84,163.50},{21.38,78.71},{92.79,174.58},{85.51,148.64},
  {37.20,74.42},{42.82,104.01},{14.45,47.55},{47.50,106.56},
  {77.45,151.76},{18.94,64.84},{86.18,130.86},{52.06,114.27},
  {42.82,96.25},{97.73,172.35},{86.38,172.44},{80.49,146.71},
  {84.86,169.04},{22.24,74.55},{55.09,105.86},{23.35,57.81},
  {52.81,106.90},{15.24,53.90},{ 8.23,54.14},{62.74,115.55},
  {92.98,158.54},{10.13,52.81},{22.09,72.33},{83.88,152.39},
  {77.45,141.89},{76.56,135.01},{ 6.72,47.66},{84.01,136.12},
  {56.03,108.55},{16.50,60.35},{17.10,52.94},{91.01,174.42},
  {18.82,44.47},{43.88,69.89},{28.81,71.54},{25.80,62.44},
  {58.55,105.67},{46.75,99.84},{46.32,91.71},{66.80,116.98},
  {54.99,112.52},{19.93,51.68},{20.39,90.40},{ 0.32,22.85},
  {64.49,113.00},{ 4.31,45.37},{69.93,131.31},{ 9.09,50.22},
  {66.51,134.99},{71.53,142.89},{94.69,164.31},{67.47,129.51},
  {17.02,52.14},{62.72,126.44},{64.63,118.30},{ 8.73,62.43},
  {54.99,105.30},{ 1.72,32.94},{67.94,122.44},{81.34,134.96},
  {40.19,107.48},{38.98,93.43},{43.18,100.43},{96.95,158.15},
  { 8.76,59.65},{72.87,133.20},{ 7.67,32.87},{30.14,73.14},
  {30.94,87.60},{36.21,67.38},{84.75,148.63},{42.37,92.14},
  {57.45,89.44},{22.34,58.13},{ 6.71,46.22},{26.96,62.93},
  {95.88,160.18},{45.15,92.15},{51.55,99.35},{99.53,183.95},
  {78.59,135.03},{50.41,121.09},{41.12,82.51},{14.19,42.95},
  {45.54,90.98},{32.17,66.82},{63.84,111.07},{35.82,115.42},
  {33.67,68.26},{26.82,67.95},{17.87,56.85},{41.48,96.39},
  {61.91,121.91},{82.90,160.36},{61.40,122.98},{75.70,139.35},
  {15.67,48.68},{20.21,51.17},{85.68,141.23},{23.16,56.02},
  {29.94,94.86},{84.23,157.80},{62.23,117.13},{ 2.90,44.01},
  {58.41,104.41},{25.84,70.46},{82.92,131.09},{33.35,78.09},
  {45.07,103.82},{15.84,48.03},{79.91,137.11},{57.89,114.28},
  {18.49,81.91},{83.41,147.12},{34.91,72.46},{43.81,99.28},
  {19.06,63.62},{79.95,168.89},{72.10,150.58},{ 5.98,32.41},
  {17.91,61.98},{81.49,142.05},{96.41,191.93},{17.76,51.22},
  {66.99,119.49},{92.90,150.18},{41.48,92.35},{81.50,140.44},
  {85.97,144.78},{73.84,137.67},{44.70,89.19},{60.74,97.65},
  { 1.22,36.30},{14.04,48.71},{21.64,66.17},{ 9.92,45.77},
  {83.36,149.45},{24.37,83.44},{98.05,151.32},{10.71,32.11},
  { 6.76,41.60},{ 6.97,52.54},{99.59,177.56},{52.19,107.98},
  {77.50,133.93},{42.21,91.84},{ 0.83,19.84},{61.95,123.49},
  {25.14,59.46},{39.82,103.52},{21.20,66.44},{78.24,145.47},
  {61.65,111.97},{46.13,98.11},{44.15,111.51},{43.73,98.25},
  {58.48,133.03},{ 9.69,55.22},{28.15,78.01},{26.55,67.67},
  {47.89,95.03},{45.25,105.34},{52.11,107.16},{67.88,136.32},
  {67.18,141.72},{ 0.56,39.51},{97.50,163.13},{97.74,183.16},
  {38.65,99.95},{86.74,166.57},{84.77,154.68},{55.22,102.68},
  {39.58,91.39},{50.30,116.57},{ 9.53,48.32},{46.52,95.78},
  {76.86,155.26},{39.16,86.79},{68.45,122.15},{ 0.37,25.57},
  {69.13,118.33},{21.73,63.27},{38.43,81.18},{60.78,107.82},
  {94.81,161.92},{18.06,58.91},{51.39,110.00},{11.14,56.09},
  {41.19,87.73},{81.41,143.96},{60.47,130.39},{35.89,104.62},
  {34.06,76.51},{98.13,163.73},{ 7.83,36.20},{20.18,63.01},
  {62.68,141.53},{18.69,46.81},{72.63,133.53},{53.57,114.29},
  {11.12,48.45},{90.99,158.91},{94.00,178.74},{12.13,34.95},
  {57.97,113.60},{95.88,165.68},{27.91,77.60},{42.82,80.76},
  {62.61,127.46},{81.37,141.13},{73.33,122.42},{92.46,171.54},
  {76.18,136.41},{13.91,44.68},{66.16,136.02},{91.20,164.13},
  {15.38,40.15},{79.64,153.51},{53.56,116.75},{40.42,78.54},
  {72.61,139.07},{68.83,113.72},{81.97,137.54},{44.84,81.49},
  {16.12,54.46},{ 1.06,39.81},{82.98,164.46},{43.91,88.72},
  {50.09,95.44},{79.60,132.97},{43.99,97.76},{71.77,125.15},
  {60.54,116.67},{60.51,135.84},{47.11,101.02},{52.50,95.91},
  {81.59,147.82},{74.46,157.07},{82.93,122.92},{80.18,146.16},
  {44.43,100.81},{64.92,121.46},{ 9.93,56.01},{37.96,84.46},
  {71.85,146.62},{11.78,67.82},{41.94,90.41},{20.48,56.10},
  {71.69,133.28},{63.62,118.47},{96.83,159.75},{33.33,88.04},
  {74.22,140.28},{93.24,148.03},{96.21,178.91},{86.36,140.64},
  {44.38,102.08},{98.34,184.66},{19.31,55.89},{78.13,145.28},
  {92.87,171.63},{37.60,96.40},{ 4.55,27.58},{97.83,150.29},
  {17.81,63.13},{40.42,75.67},{12.02,43.74},{71.23,135.07},
  {84.78,155.12},{ 0.98,41.03},{78.10,154.67},{20.14,49.90},
  {15.12,59.68},{ 5.60,39.60},{44.08,82.92},{27.13,68.18},
  {20.27,50.64},{11.44,48.72},{46.75,79.18},{28.80,68.56},
  {48.06,71.40},{61.74,126.08},{78.51,149.96},{23.11,47.96},
  { 4.09,13.42},{90.60,173.81},{13.51,34.96},{36.21,66.80},
  {24.20,69.57},{77.64,151.03},{27.27,77.78},{35.61,81.34},
  {93.32,166.27},{98.48,177.66},{50.61,109.79},{27.75,85.62},
  {41.54,75.87},{68.32,134.81},{ 4.39,46.93},{42.78,88.70},
  {77.23,148.34},{51.44,114.80},{53.50,100.58},{64.61,136.57},
  {11.73,43.51},{67.07,116.97},{78.43,130.95},{21.64,64.62},
  {67.18,126.57},{98.33,156.34},{40.35,84.08},{84.76,138.97},
  {88.80,153.26},{27.28,90.09},{26.00,71.03},{29.74,85.66},
  {29.29,80.17},{12.35,58.96},{53.07,108.70},{69.57,126.42},
  {47.17,98.36},{66.69,127.77},{ 7.59,38.13},{22.50,54.49},
  {99.34,165.22},{76.53,156.06},{65.67,138.08},{94.39,169.99},
  {33.39,70.11},{25.35,75.86},{78.02,147.30},{71.88,146.01},
  {61.78,125.26},{17.81,56.79},{78.34,127.25},{63.24,124.42},
  {35.49,65.93},{88.50,135.99},{55.81,121.25},{42.29,96.73},
  { 1.01, 8.14},{91.33,157.62},{45.87,90.97},{51.73,110.65},
  {53.46,92.39},{44.89,94.33},{ 2.53,22.45},{52.20,119.53},
  {86.50,154.46},{61.16,120.06},{81.93,143.24},{22.43,66.72},
  {55.54,119.80},{21.63,55.22},{95.49,162.81},{56.15,102.38},
  {50.47,114.96},{69.29,157.22},{84.07,152.06},{44.85,92.85},
  {43.42,72.68},{64.43,124.97},{ 1.30,41.74},{86.48,156.03},
  {45.41,105.64},{80.87,129.72},{54.06,118.03},{32.33,76.60},
  {59.61,124.94},{50.10,122.29},{62.75,121.79},{73.06,137.32},
  {93.52,168.06},{84.08,143.49},{86.90,162.96},{62.21,124.40},
  {75.82,145.04},{66.18,117.84},{73.46,134.08},{ 3.85,46.80},
  {16.35,38.06},{74.64,125.74},{84.88,147.96},{45.88,108.25},
  {68.20,133.02},{93.17,157.94},{78.44,137.10},{48.49,99.27},
  {44.66,89.84},{49.14,96.83},{13.51,60.56},{72.82,134.69},
  {99.78,182.23},{42.30,98.18},{ 1.09,46.50},{77.99,125.36},
  {15.17,47.52},{44.67,85.36},{97.61,158.08},{97.28,163.57},
  { 8.85,42.18},{10.94,44.22},{17.27,60.97},{34.31,91.96},
  {51.58,122.05},{90.37,125.36},{70.15,131.94},{54.54,90.98},
  {53.27,112.46},{13.87,41.24},{11.61,67.96},{16.74,43.06},
  { 1.34,59.97},{20.81,39.07},{57.54,118.81},{27.02,61.54},
  {63.37,110.32},{45.25,92.88},{46.06,81.22},{85.33,163.96},
  {64.04,123.39},{67.89,125.06},{42.45,82.67},{ 1.95,38.34},
  { 1.80,17.74},{49.62,100.96},{55.75,105.37},{69.43,132.55},
  {25.29,73.09},{31.23,62.86},{64.61,120.23},{22.32,76.45},
  {89.14,152.81},{90.77,168.96},{53.33,122.05},{ 2.60,29.68},
  {76.15,130.26},{ 2.90,44.58},{40.18,91.71},{55.19,112.74},
  {56.22,119.09},{12.03,50.22},{92.64,161.03},{32.38,85.89},
  {51.93,107.78},{33.86,66.31},{ 2.49,24.30},{65.14,123.39},
  {24.35,79.57},{80.36,149.08},{91.39,171.33},{84.09,142.12},
  {23.54,87.61},{27.47,75.55},{51.40,103.34},{20.88,78.79}
};
